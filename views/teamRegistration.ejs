<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/GLOSLogo.png">
    <link rel="stylesheet" href="/siteStyles.css">
    <title>Season Registration</title>
    
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: rgba(206, 255, 0, 0.50);
            /* background-color: #ceff00;
            opacity: 0.3; */
            /* background-color: #f4f4f4; */
        }
        html, body {
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            background-image: url('/silverBackground.jpg');
                background-size: cover;
                background-position: center;
                background-repeat: no-repeat;
                height: 100%;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #f4f4f4;
        }
        .container {

        display: flex;

        justify-content: center;

        align-items: center;

        }
        #registerButton {
            /* background-color: #ceff00; */
            font-size: 3vh;
            /* border-width: medium;
            border-color: black;
            font-weight: 500;
            border-style: solid;
            color: black; */
            padding: 5px 40px 5px 40px;
        }
        .buttonStyle {
            background-color: #ceff00;
            /* font-size: 3vh; */
            border-width: medium;
            border-color: black;
            font-weight: 500;
            border-style: solid;
            color: black;
            /* padding: 5px 40px 5px 40px; */
        }
        input:focus, textarea:focus, select:focus {
            outline: 2px solid #ceff00; /* Change to your preferred color */
        }
        ::selection {
            background: #ceff00; 
            color: #121212; 
        }
        
        .color-dropdown {
    position: relative;
    display: inline-block;
  }

  .dropdown-btn {
    padding: 10px;
    border: 1px solid #ccc;
    cursor: pointer;
    display: flex;
    align-items: center;
  }

  .dropdown-menu {
    display: none;
    position: absolute;
    background: white;
    border: 1px solid #ccc;
    width: 100px;
  }

  .dropdown-menu div {
    padding: 10px;
    cursor: pointer;
  }

  .red { background: #ff0000; }
  .green { background: #00ff00; }
  .blue { background: #0000ff; }

  .dropdown-menu div:hover {
    opacity: 0.8;
  }
        /* input::selection, textarea::selection {
            background: #ceff00;
            color: #121212;
        } */

    </style>
</head>
<body style="text-align: center; width: 100%;" >
    <div style="background-image: linear-gradient(180deg, #CEFF00 0%, #4E6100 100%); width: 100%;">
         <img style="padding: 12px 0 0 0;" height="200vh" src="/GLOS-Emblem-Black.png" alt="GLOS Logo" id="mainLogo" onclick="window.location.href='https://envoroot.com/'">
        <h1 style="color: #121212; margin: 0; padding: 15px 0px 20px 0px;"><%= data.season.seasonName %> Team Registration</h1>
    </div>
   
    
    <form id="teamSeasonRegistrationForm" action="/api/payments/individualSeasonCheckoutSession" method="post" style="padding: 24px 0 24px 0;" autocomplete="off">
        <input type="hidden" name="seasonId" id="" value="<%= data.seasonId%>">
        <input type="text" name="teamFullName" placeholder="Team Full Name" value="<%= data.userAttributes.firstName ? data.userAttributes.firstName : ''  %>" required>
        <input type="text" name="teamShortName" placeholder="Team Short Name" value="<%= data.userAttributes.lastName ? data.userAttributes.lastName : ''  %>" required>
        <br>
        <br>
        <input type="text" name="teamAbbreviation" placeholder="Team Abbreviation" value="<%= data.userAttributes.email ? data.userAttributes.email : ''  %>" required>
        <input type="tel" name="phone" placeholder="Phone Number" value="<%= data.userAttributes.phone ? data.userAttributes.phone : ''  %>" required>
        <br>
        <br>
        
    
        <br>
        <label for="skill"><b>Rate your Team's Experience Level:</b></label>
        <select name="skill" id="" required>
            <option value="1" <%= data.userAttributes.skill == '1' ? 'selected' : ''  %>>1 - What's a soccer ball?</option>
            <option value="2" <%= data.userAttributes.skill == '2' ? 'selected' : ''  %>>2 - Running is overrated</option>
            <option value="3" <%= !['1', '2', '4', '5', 1, 2, 4, 5].includes(data.userAttributes.skill) ? 'selected' : ''  %>>3 - We used to play back in the day</option>
            <option value="4" <%= data.userAttributes.skill == '4' ? 'selected' : ''  %>>4 - We play regularly</option>
            <option value="5" <%= data.userAttributes.skill == '5' ? 'selected' : ''  %>>5 - We live for soccer</option>
        </select>
        <br><br>
        
        <label for=""><b>League:</b></label>
        
        <select name="" id="">
            <option value="" disabled selected>League</option>
            <% for(let league of data.leagues){ %>
                <option value="<%= league.leagueId %>"> <%= league.leagueShortName %></option>
                
            <% } %>
        </select>
        <br><br>
        <label for=""><b>Division:</b></label>
        <select name="" id="">
            <option value="" disabled selected>Division</option>
            <option value="upper">Upper</option>
            <option value="lower">Lower</option>
            <option value="either">Either</option>
        </select>
        <!-- <input type="text" name="medicalConditions" placeholder="List Medical Conditions"> -->
        <br><br>
        <input type="text" name="teamShirtColor1" id="teamShirtColor1" value="" hidden>
              <label for=""><b>Team Shirt Color 1: </b></label>
              <div class="color-dropdown">
                <div class="dropdown-btn" onclick="toggleDropdown(this)">Click to Select</div>
                <div class="dropdown-menu">
                  <div class="red" style="background-color: #00FF00;" onclick="selectColor('#00FF00','Lime')">Lime</div>
                  <div class="green" style="background-color: #da70d6;" onclick="selectColor('#da70d6','Orchid')">Orchid</div>
                  <div class="blue" style="background-color: #FF69B4;" onclick="selectColor('#FF69B4','Pink')">Pink</div>
                  <div class="blue" style="background-color: #0F52BA;" onclick="selectColor('#0F52BA','Sapphire')">Sapphire</div>
                </div>
              </div>
              <br>
              <input type="text" name="teamShirtColor2" id="teamShirtColor2" value="" hidden>
              <label for=""><b>Team Shirt Color 2: </b></label>
              <div class="color-dropdown">
                <div class="dropdown-btn" onclick="toggleDropdown(this)">Click to Select</div>
                <div class="dropdown-menu">
                  <div class="red" style="background-color: #00FF00;" onclick="selectColor('#00FF00','Lime')">Lime</div>
                  <div class="green" style="background-color: #da70d6;" onclick="selectColor('#da70d6','Orchid')">Orchid</div>
                  <div class="blue" style="background-color: #FF69B4;" onclick="selectColor('#FF69B4','Pink')">Pink</div>
                  <div class="blue" style="background-color: #0F52BA;" onclick="selectColor('#0F52BA','Sapphire')">Sapphire</div>
                </div>
              </div>
              <br>
              <input type="text" name="teamShirtColor3" id="teamShirtColor3" value="" hidden>
              <label for=""><b>Team Shirt Color 3: </b></label>
              <div class="color-dropdown">
                <div class="dropdown-btn" onclick="toggleDropdown(this)">Click to Select</div>
                <div class="dropdown-menu">
                  <div class="red" style="background-color: #00FF00;" onclick="selectColor('#00FF00','Lime')">Lime</div>
                  <div class="green" style="background-color: #da70d6;" onclick="selectColor('#da70d6','Orchid')">Orchid</div>
                  <div class="blue" style="background-color: #FF69B4;" onclick="selectColor('#FF69B4','Pink')">Pink</div>
                  <div class="blue" style="background-color: #0F52BA;" onclick="selectColor('#0F52BA','Sapphire')">Sapphire</div>
                </div>
              </div>
            <br><br><br>  
            <label for=""><b>Roster: </b></label>
            <br>
            <button type="button" class="buttonStyle" style="background-color: #ceff00;" onclick="toggleForm(document.getElementById('newPlayerFormTeamRegistration'),document.getElementById('formBackground'))">Add Player</button>
            <table>
                <thead>
                    <tr>
                        <th>
                            Email
                        </th>
                        <th>
                            First Name
                        </th>
                        <th>
                            Last Name
                        </th>
                        <th>
                            Shirt Size
                        </th>
                        <th>
                            Captain?
                        </th>
                        <th>
                            Keeper?
                        </th>
                        <th>
                            Student, Teacher,
                            <br>
                            First Responder, or Military?
                        </th>
                        <th>
                            Paying Now
                            <br><br>
                            <button class="buttonStyle">Select All</button>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <input type="text">
                        </td>
                        <td>
                            <input type="text">
                        </td>
                        <td>
                            <input type="text" name="" id="">
                        </td>
                        <td>
                            <select name="" id=""></select>
                        </td>
                        <td>
                            <input type="radio">
                        </td>
                        <td>
                            <input type="radio">
                        </td>
                        <td>
                            <input type="checkbox">
                        </td>
                        <td>
                            <input type="checkbox">
                        </td>
                    </tr>
                </tbody>
            </table>
            <br>
            <button type="button" class="buttonStyle formButton" onclick="history.back()">Back</button>
        <button class="buttonStyle formButton" style="background-color: #ceff00;" id="registerButton">Continue To Player Registration</button>
    </form>
    <script>
        document.addEventListener("input", function(event) {
        if (event.target.classList.contains("allergy-input")) {
            handleDynamicInputs("allergy-list", "allergy-input", "allergies[]", "Enter an allergy");
        } else if (event.target.classList.contains("medical-input")) {
            handleDynamicInputs("medical-list", "medical-input", "medicalConditions[]", "Enter a medical condition");
        }
    });

    function handleDynamicInputs(listId, inputClass, inputName, placeholderText) {
        let list = document.getElementById(listId);
        let inputs = list.querySelectorAll(`.${inputClass}`);
        
        // Count blank inputs
        let blankInputs = Array.from(inputs).filter(input => input.value.trim() === "");
        
        // If more than one blank input, remove the last one
        if (blankInputs.length > 1) {
            list.removeChild(blankInputs[blankInputs.length - 1].previousSibling); // Remove <br>
            list.removeChild(blankInputs[blankInputs.length - 1]); // Remove input
            return;
        }

        // If the last input has a value, add a new one
        let lastInput = inputs[inputs.length - 1];
        if (lastInput.value.trim() !== "") {
            let newBr = document.createElement("br");
            let newInput = document.createElement("input");
            newInput.type = "text";
            newInput.name = inputName;
            newInput.placeholder = placeholderText;
            newInput.classList.add(inputClass);

            list.appendChild(newBr);
            list.appendChild(newInput);
        }
    }
  
document.querySelectorAll('input[type="tel"]').forEach(input => {
  input.addEventListener('input', function (e) {
    let value = e.target.value.replace(/\D/g, ""); // Remove non-digits
    if (value.length > 3) value = value.replace(/^(\d{3})/, "$1-");
    if (value.length > 6) value = value.replace(/^(\d{3})-(\d{3})/, "$1-$2-");
    e.target.value = value.slice(0, 12); // Max: XXX-XXX-XXXX
  });
});
document.getElementById('individualSeasonRegistrationForm').addEventListener('submit', function(event) {
    // Check if at least one checkbox is selected
    const checkboxes = document.querySelectorAll('input[name^="leagueId"]:checked');
    
    if (checkboxes.length === 0) {
      alert('Please select at least one league!');
      event.preventDefault(); // Prevent form submission
    }
    handleSubmit(this,event)
  });
  function handleSubmit(form,event) {
            // if (!validateCheckboxes(form)) {
            //     return false; 
            // }
            paymentSubmit(form,event, 'individualSeasonCheckoutSession')
        }
//   async function handlePlayerRegistrationSubmit(form, event) {
//     let formData = new FormData(form)
//     console.log(formData);
//     await fetch('registration', {
//         method: 'POST',
//         headers: {
//             'Content-Type': 'application/x-www-form-urlencoded',
//         },
//         body: new URLSearchParams(formData).toString(),
//     });

//     }
        function leagueSelect(ele){
            // console.log(document.getElementById(`${ele.id.replace('leagueId_','')}_teamId`))
            document.getElementById(`${ele.id.replace('leagueId_','')}_teamId`).style.display = ele.checked ? "" : "none"
            document.getElementById(`${ele.id.replace('leagueId_','')}_division`).style.display = ele.checked ? "" : "none"
        }
        function toggleDropdown() {
            document.querySelector(".dropdown-menu").style.display = 
            document.querySelector(".dropdown-menu").style.display === "block" ? "none" : "block";
        }

        function selectColor(color,name) {
            document.querySelector(".dropdown-btn").textContent = name;
            document.getElementById("keeperShirtColor").value = name
            document.querySelector(".dropdown-btn").style.backgroundColor = color
            document.querySelector(".dropdown-menu").style.display = "none";
        }
        function keeperChange() {
            const conditionalDiv = document.getElementById('keeperColorContainer');
            if (document.getElementById('keeper_yes').checked) {
                document.getElementById('keeperColorContainer').style.display = 'block';
                document.getElementById('keeperShirtColor').setAttribute('required', '')
            } else {
                document.getElementById('keeperColorContainer').style.display = 'none';
                document.getElementById('keeperShirtColor').removeAttribute('required')
            }
        }
        async function toggleAddPlayerTeamRegistrationForm(form){
            // let teamForm = document.getElementById('teamForm')
            if(document.getElementById('formBackgroundSite').style.display == 'none'){
                document.getElementById('formBackgroundSite').style.display = ''
            }else{
                document.getElementById('formBackgroundSite').style.display = 'none'
            }
            if(form.style.display == 'none'){
                form.style.display = ''
            }else{
                form.style.display = 'none'
            }
        }
    </script>
    <script src="/main.js"></script>
    <div id="formBackground" style="display: none; touch-action: none;" onclick="closeForm()"></div>
    <%- include('newPlayerFormTeamRegistration'); %>
    <%- include('playerSearchForm'); %>
</body>
</html>
